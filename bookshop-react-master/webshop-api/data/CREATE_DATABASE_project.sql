-- SQLBook: Code
-- Active: 1735109226295@@127.0.0.1@3306
-- SQLBook: Code
CREATE DATABASE project;
USE project;


CREATE TABLE MEMBER (
    Member_ID INT PRIMARY KEY AUTO_INCREMENT,
    Name VARCHAR(100),
    Email VARCHAR(100) UNIQUE,
    Password VARCHAR(255),
    Phone VARCHAR(20),
    Birthday DATE,
    Last_login TIMESTAMP,
    Register_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Status INT DEFAULT 1
);


-- ADMINISTRATOR 表
CREATE TABLE ADMINISTRATOR (
    Admin_ID INT PRIMARY KEY  AUTO_INCREMENT,
    Member_ID INT,
    FOREIGN KEY (Member_ID) REFERENCES MEMBER(Member_ID)
);

-- VENDOR 表
CREATE TABLE VENDOR (
    Vendor_ID INT PRIMARY KEY  AUTO_INCREMENT,
    Member_ID INT,
    Is_active INT DEFAULT 1,
    FOREIGN KEY (Member_ID) REFERENCES MEMBER(Member_ID)
);

CREATE TABLE PRODUCT (
    Product_ID INT PRIMARY KEY AUTO_INCREMENT,
    Product_name VARCHAR(255),
    Description TEXT,
    Author VARCHAR(100),
    Price DECIMAL(10, 2),
    Stock INT,
    Status VARCHAR(50),
    New_arrival_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    Product_image VARCHAR(255),
    Seller_ID INT,
    FOREIGN KEY (Seller_ID) REFERENCES VENDOR(Vendor_ID)
);


CREATE TABLE BOOK_CATEGORY (
    Category_ID INT PRIMARY KEY  AUTO_INCREMENT,
    Category_name VARCHAR(100)
);

CREATE TABLE PRODUCT_CATEGORY (
    Product_ID INT,
    Category_ID INT,
    PRIMARY KEY (Product_ID, Category_ID),
    FOREIGN KEY (Product_ID) REFERENCES PRODUCT(Product_ID),
    FOREIGN KEY (Category_ID) REFERENCES BOOK_CATEGORY(Category_ID)
);

CREATE TABLE SHOPPING_CART (
    Cart_ID INT PRIMARY KEY  AUTO_INCREMENT,
    Member_ID INT,
    Total_price DECIMAL(10, 2),
    FOREIGN KEY (Member_ID) REFERENCES MEMBER(Member_ID)
);

-- DROP TABLE IF EXISTS CART_PRODUCT;

CREATE TABLE CART_PRODUCT (
    Cart_ID INT,
    Product_ID INT,
    Quantity INT,
    PRIMARY KEY (Cart_ID, Product_ID),
    FOREIGN KEY (Cart_ID) REFERENCES SHOPPING_CART(Cart_ID) ON DELETE CASCADE,
    FOREIGN KEY (Product_ID) REFERENCES PRODUCT(Product_ID)
);


CREATE TABLE COUPON (
    Coupon_ID INT PRIMARY KEY  AUTO_INCREMENT,
    Low_money DECIMAL(10, 2),
    Start_date DATE,
    End_date DATE,
    Detail TEXT,
    Type VARCHAR(50),
    Owner_ID INT,
    Sender_ID INT,
    Used INT DEFAULT 0,
    FOREIGN KEY (Owner_ID) REFERENCES MEMBER(MEMBER_ID),
    FOREIGN KEY (Sender_ID) REFERENCES ADMINISTRATOR(ADMIN_ID)
);

CREATE TABLE ORDER_ (
    Order_ID INT PRIMARY KEY  AUTO_INCREMENT,
    Order_time TIMESTAMP,
    Status VARCHAR(50),
    Package_method VARCHAR(50),
    Payment_method VARCHAR(50),
    Address VARCHAR(255),
    Notes TEXT,
    Buyer_ID INT,
    Coupon_used_ID INT,
    Total_Price INT,
    Status_update_time TIMESTAMP NULL,
    FOREIGN KEY (Buyer_ID) REFERENCES MEMBER(MEMBER_ID),
    FOREIGN KEY (Coupon_used_ID) REFERENCES COUPON(Coupon_ID)
);

CREATE TABLE ORDER_PRODUCT (
    Order_ID INT,
    Product_ID INT,
    Quantity INT,
    Price INT,
    PRIMARY KEY (Order_ID, Product_ID),
    FOREIGN KEY (Order_ID) REFERENCES ORDER_(Order_ID),
    FOREIGN KEY (Product_ID) REFERENCES PRODUCT(Product_ID)
);

show tables;


